<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>JQuad AI Assistant - Localization Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .locale-switch {
            margin-bottom: 20px;
            text-align: center;
        }
        button {
            padding: 8px 16px;
            margin: 0 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background: #0078d4;
            color: white;
        }
        button:hover {
            background: #106ebe;
        }
        .current-locale {
            font-weight: bold;
            color: #0078d4;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .lang-column {
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .lang-column h4 {
            margin-top: 0;
            color: #0078d4;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ü§ñ JQuad AI Assistant - Localization Test</h1>
        
        <div class="locale-switch">
            <p>Test Locale Switching: <span id="current-locale" class="current-locale">English</span></p>
            <button onclick="setLocale('en')">Switch to English</button>
            <button onclick="setLocale('de')">Switch to German</button>
        </div>

        <div class="comparison">
            <div class="lang-column">
                <h4>üá∫üá∏ English</h4>
                <div id="english-content">
                    <p><strong>App Title:</strong> JQuad AI Assistant</p>
                    <p><strong>Status Ready:</strong> Ready</p>
                    <p><strong>Status Thinking:</strong> AI is thinking...</p>
                    <p><strong>Email Subject:</strong> Subject:</p>
                    <p><strong>Email From:</strong> From:</p>
                    <p><strong>Email To:</strong> To:</p>
                    <p><strong>Chat Title:</strong> Chat with AI Assistant</p>
                    <p><strong>Button Accept:</strong> Accept</p>
                    <p><strong>Button Edit:</strong> Edit</p>
                    <p><strong>Button Reject:</strong> Reject</p>
                    <p><strong>Connection Status:</strong> Connected to agent service</p>
                </div>
            </div>
            
            <div class="lang-column">
                <h4>üá©üá™ German</h4>
                <div id="german-content">
                    <p><strong>App Title:</strong> JQuad KI-Assistent</p>
                    <p><strong>Status Ready:</strong> Bereit</p>
                    <p><strong>Status Thinking:</strong> KI denkt nach...</p>
                    <p><strong>Email Subject:</strong> Betreff:</p>
                    <p><strong>Email From:</strong> Von:</p>
                    <p><strong>Email To:</strong> An:</p>
                    <p><strong>Chat Title:</strong> Chat mit KI-Assistent</p>
                    <p><strong>Button Accept:</strong> Akzeptieren</p>
                    <p><strong>Button Edit:</strong> Bearbeiten</p>
                    <p><strong>Button Reject:</strong> Ablehnen</p>
                    <p><strong>Connection Status:</strong> Mit Agent-Service verbunden</p>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>üîÑ Dynamic Test Area</h3>
            <p>This area demonstrates the language switching functionality:</p>
            
            <div id="dynamic-test" style="padding: 15px; background: #f8f9fa; border-radius: 5px; border-left: 4px solid #0078d4;">
                <h4 id="test-app-title">ü§ñ JQuad AI Assistant</h4>
                <p><span id="test-email-subject">Subject:</span> Important Meeting Tomorrow</p>
                <p><span id="test-email-from">From:</span> manager@company.com</p>
                <p><span id="test-email-to">To:</span> team@company.com</p>
                <p><strong>Status:</strong> <span id="test-status">Ready</span></p>
                <div style="margin-top: 10px;">
                    <button id="test-btn-accept">‚úÖ <span id="test-btn-accept-text">Accept</span></button>
                    <button id="test-btn-edit">‚úèÔ∏è <span id="test-btn-edit-text">Edit</span></button>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>üìù Chat Interface Preview</h3>
            <div style="background: #f0f8ff; padding: 15px; border-radius: 5px;">
                <h4 id="test-chat-title">üí¨ Chat with AI Assistant</h4>
                <div id="test-welcome-message" style="font-style: italic; margin: 10px 0;">
                    Hi! I can help you with this email. Try asking me:<br/>
                    ‚Ä¢ "Extract the key tasks from this email"<br/>
                    ‚Ä¢ "Write a professional reply"<br/>
                    ‚Ä¢ "Summarize this email"<br/>
                    ‚Ä¢ "What's the sentiment here?"<br/>
                    Or just ask me anything about the email!
                </div>
                <textarea id="test-chat-input" style="width: 100%; margin-top: 10px;" rows="2" 
                    placeholder="Ask me anything about this email... (Press Enter to send, Shift+Enter for new line)"></textarea>
            </div>
        </div>

        <div class="test-section">
            <h3>‚ö° Fixed: Immediate Language Detection</h3>
            <p>‚úÖ <strong>FIXED:</strong> The plugin now detects Outlook's language immediately when Office.js loads:</p>
            <div id="office-simulation" style="background: #d4edda; padding: 15px; border-radius: 4px; border-left: 4px solid #28a745;">
                <p><strong>üîß Fix Applied:</strong> Language detection moved to <code>Office.onReady()</code></p>
                <p><strong>‚ö° Timing:</strong> Localization happens BEFORE any UI is created</p>
                <p><strong>üéØ Result:</strong> Plugin starts in the correct language immediately</p>
                <p><strong>Simulated Detection:</strong> <span id="office-display-lang">en-US</span> ‚Üí <span id="plugin-lang">English</span></p>
                <p><strong>User Experience:</strong> <span id="auto-action">No language switching - appears correct from start</span></p>
            </div>
            
            <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin-top: 10px; border-left: 4px solid #0078d4;">
                <p><strong>üìù Implementation Details:</strong></p>
                <ul style="margin: 5px 0; padding-left: 20px;">
                    <li>Language detection: <code>Office.context.displayLanguage</code></li>
                    <li>Fallback: <code>Office.context.contentLanguage</code></li>
                    <li>Timing: Synchronous execution in <code>Office.onReady()</code></li>
                    <li>UI Update: Immediate localization before assistant initialization</li>
                    <li>‚ú® NEW: AI Response Language: Prompts include language instructions</li>
                    <li>‚ú® NEW: Suggestion Buttons: Use localized prompts instead of hardcoded English</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Simplified localization strings for testing
        const strings = {
            en: {
                appTitle: "JQuad AI Assistant",
                status: {
                    ready: "Ready",
                    thinking: "AI is thinking..."
                },
                emailContext: {
                    subject: "Subject:",
                    from: "From:",
                    to: "To:"
                },
                buttons: {
                    accept: "Accept",
                    edit: "Edit",
                    reject: "Reject"
                },
                chat: {
                    title: "Chat with AI Assistant",
                    placeholder: "Ask me anything about this email... (Press Enter to send, Shift+Enter for new line)",
                    welcomeMessage: `Hi! I can help you with this email. Try asking me:<br/>
‚Ä¢ "Extract the key tasks from this email"<br/>
‚Ä¢ "Write a professional reply"<br/>
‚Ä¢ "Summarize this email"<br/>
‚Ä¢ "What's the sentiment here?"<br/>
Or just ask me anything about the email!`
                },
                connectionStatus: {
                    connected: "Connected to agent service"
                }
            },
            de: {
                appTitle: "JQuad KI-Assistent",
                status: {
                    ready: "Bereit",
                    thinking: "KI denkt nach..."
                },
                emailContext: {
                    subject: "Betreff:",
                    from: "Von:",
                    to: "An:"
                },
                buttons: {
                    accept: "Akzeptieren",
                    edit: "Bearbeiten",
                    reject: "Ablehnen"
                },
                chat: {
                    title: "Chat mit KI-Assistent",
                    placeholder: "Fragen Sie mich alles √ºber diese E-Mail... (Enter zum Senden, Shift+Enter f√ºr neue Zeile)",
                    welcomeMessage: `Hallo! Ich kann Ihnen bei dieser E-Mail helfen. Versuchen Sie zu fragen:<br/>
‚Ä¢ "Extrahiere die wichtigsten Aufgaben aus dieser E-Mail"<br/>
‚Ä¢ "Schreibe eine professionelle Antwort"<br/>
‚Ä¢ "Fasse diese E-Mail zusammen"<br/>
‚Ä¢ "Wie ist die Stimmung hier?"<br/>
Oder fragen Sie mich einfach alles √ºber die E-Mail!`
                },
                connectionStatus: {
                    connected: "Mit Agent-Service verbunden"
                }
            }
        };

        let currentLocale = 'en';

        function updateDynamicTest() {
            const s = strings[currentLocale];
            
            // Update dynamic test area
            document.getElementById('test-app-title').textContent = `ü§ñ ${s.appTitle}`;
            document.getElementById('test-email-subject').textContent = s.emailContext.subject;
            document.getElementById('test-email-from').textContent = s.emailContext.from;
            document.getElementById('test-email-to').textContent = s.emailContext.to;
            document.getElementById('test-status').textContent = s.status.ready;
            document.getElementById('test-btn-accept-text').textContent = s.buttons.accept;
            document.getElementById('test-btn-edit-text').textContent = s.buttons.edit;
            
            // Update chat
            document.getElementById('test-chat-title').textContent = `üí¨ ${s.chat.title}`;
            document.getElementById('test-welcome-message').innerHTML = s.chat.welcomeMessage;
            document.getElementById('test-chat-input').placeholder = s.chat.placeholder;
        }

        function setLocale(locale) {
            currentLocale = locale;
            
            // Update current locale display
            document.getElementById('current-locale').textContent = locale === 'en' ? 'English' : 'German';
            
            // Update Office.js simulation
            const officeLang = locale === 'en' ? 'en-US' : 'de-DE';
            document.getElementById('office-display-lang').textContent = officeLang;
            document.getElementById('plugin-lang').textContent = locale === 'en' ? 'English' : 'German';
            document.getElementById('auto-action').textContent = `Plugin UI switches to ${locale === 'en' ? 'English' : 'German'}`;
            
            // Update dynamic test area
            updateDynamicTest();
            
            // Visual feedback
            const dynamicTest = document.getElementById('dynamic-test');
            dynamicTest.style.borderLeftColor = locale === 'en' ? '#0078d4' : '#d13212';
            dynamicTest.style.background = locale === 'en' ? '#f8f9fa' : '#fff5f5';
        }

        // Initialize with English
        document.addEventListener('DOMContentLoaded', function() {
            updateDynamicTest();
        });
    </script>
</body>
</html>
